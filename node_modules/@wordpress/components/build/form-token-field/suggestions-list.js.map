{"version":3,"sources":["@wordpress/components/src/form-token-field/suggestions-list.js"],"names":["SuggestionsList","Component","constructor","arguments","handleMouseDown","bind","bindList","componentDidUpdate","props","selectedIndex","scrollIntoView","list","children","scrollingIntoView","onlyScrollIfNeeded","setTimeout","ref","handleHover","suggestion","onHover","handleClick","onSelect","e","preventDefault","computeSuggestionMatch","match","displayTransform","toLocaleLowerCase","length","indexOfMatch","indexOf","suggestionBeforeMatch","substring","suggestionMatch","suggestionAfterMatch","render","instanceId","suggestions","index","classeName","value","defaultProps","Object","freeze"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { map } from 'lodash';\nimport scrollIntoView from 'dom-scroll-into-view';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { withSafeTimeout } from '@wordpress/compose';\n\nclass SuggestionsList extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.handleMouseDown = this.handleMouseDown.bind( this );\n\t\tthis.bindList = this.bindList.bind( this );\n\t}\n\n\tcomponentDidUpdate() {\n\t\t// only have to worry about scrolling selected suggestion into view\n\t\t// when already expanded\n\t\tif (\n\t\t\tthis.props.selectedIndex > -1 &&\n\t\t\tthis.props.scrollIntoView &&\n\t\t\tthis.list.children[ this.props.selectedIndex ]\n\t\t) {\n\t\t\tthis.scrollingIntoView = true;\n\t\t\tscrollIntoView(\n\t\t\t\tthis.list.children[ this.props.selectedIndex ],\n\t\t\t\tthis.list,\n\t\t\t\t{\n\t\t\t\t\tonlyScrollIfNeeded: true,\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.props.setTimeout( () => {\n\t\t\t\tthis.scrollingIntoView = false;\n\t\t\t}, 100 );\n\t\t}\n\t}\n\n\tbindList( ref ) {\n\t\tthis.list = ref;\n\t}\n\n\thandleHover( suggestion ) {\n\t\treturn () => {\n\t\t\tif ( ! this.scrollingIntoView ) {\n\t\t\t\tthis.props.onHover( suggestion );\n\t\t\t}\n\t\t};\n\t}\n\n\thandleClick( suggestion ) {\n\t\treturn () => {\n\t\t\tthis.props.onSelect( suggestion );\n\t\t};\n\t}\n\n\thandleMouseDown( e ) {\n\t\t// By preventing default here, we will not lose focus of <input> when clicking a suggestion\n\t\te.preventDefault();\n\t}\n\n\tcomputeSuggestionMatch( suggestion ) {\n\t\tconst match = this.props\n\t\t\t.displayTransform( this.props.match || '' )\n\t\t\t.toLocaleLowerCase();\n\t\tif ( match.length === 0 ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tsuggestion = this.props.displayTransform( suggestion );\n\t\tconst indexOfMatch = suggestion.toLocaleLowerCase().indexOf( match );\n\n\t\treturn {\n\t\t\tsuggestionBeforeMatch: suggestion.substring( 0, indexOfMatch ),\n\t\t\tsuggestionMatch: suggestion.substring(\n\t\t\t\tindexOfMatch,\n\t\t\t\tindexOfMatch + match.length\n\t\t\t),\n\t\t\tsuggestionAfterMatch: suggestion.substring(\n\t\t\t\tindexOfMatch + match.length\n\t\t\t),\n\t\t};\n\t}\n\n\trender() {\n\t\t// We set `tabIndex` here because otherwise Firefox sets focus on this\n\t\t// div when tabbing off of the input in `TokenField` -- not really sure\n\t\t// why, since usually a div isn't focusable by default\n\t\t// TODO does this still apply now that it's a <ul> and not a <div>?\n\t\treturn (\n\t\t\t<ul\n\t\t\t\tref={ this.bindList }\n\t\t\t\tclassName=\"components-form-token-field__suggestions-list\"\n\t\t\t\tid={ `components-form-token-suggestions-${ this.props.instanceId }` }\n\t\t\t\trole=\"listbox\"\n\t\t\t>\n\t\t\t\t{ map( this.props.suggestions, ( suggestion, index ) => {\n\t\t\t\t\tconst match = this.computeSuggestionMatch( suggestion );\n\t\t\t\t\tconst classeName = classnames(\n\t\t\t\t\t\t'components-form-token-field__suggestion',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t'is-selected': index === this.props.selectedIndex,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\t/* eslint-disable jsx-a11y/click-events-have-key-events */\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<li\n\t\t\t\t\t\t\tid={ `components-form-token-suggestions-${ this.props.instanceId }-${ index }` }\n\t\t\t\t\t\t\trole=\"option\"\n\t\t\t\t\t\t\tclassName={ classeName }\n\t\t\t\t\t\t\tkey={\n\t\t\t\t\t\t\t\tsuggestion?.value\n\t\t\t\t\t\t\t\t\t? suggestion.value\n\t\t\t\t\t\t\t\t\t: this.props.displayTransform( suggestion )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tonMouseDown={ this.handleMouseDown }\n\t\t\t\t\t\t\tonClick={ this.handleClick( suggestion ) }\n\t\t\t\t\t\t\tonMouseEnter={ this.handleHover( suggestion ) }\n\t\t\t\t\t\t\taria-selected={ index === this.props.selectedIndex }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ match ? (\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\taria-label={ this.props.displayTransform(\n\t\t\t\t\t\t\t\t\t\tsuggestion\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ match.suggestionBeforeMatch }\n\t\t\t\t\t\t\t\t\t<strong className=\"components-form-token-field__suggestion-match\">\n\t\t\t\t\t\t\t\t\t\t{ match.suggestionMatch }\n\t\t\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t\t\t{ match.suggestionAfterMatch }\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\tthis.props.displayTransform( suggestion )\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</li>\n\t\t\t\t\t);\n\t\t\t\t\t/* eslint-enable jsx-a11y/click-events-have-key-events */\n\t\t\t\t} ) }\n\t\t\t</ul>\n\t\t);\n\t}\n}\n\nSuggestionsList.defaultProps = {\n\tmatch: '',\n\tonHover: () => {},\n\tonSelect: () => {},\n\tsuggestions: Object.freeze( [] ),\n};\n\nexport default withSafeTimeout( SuggestionsList );\n"]}