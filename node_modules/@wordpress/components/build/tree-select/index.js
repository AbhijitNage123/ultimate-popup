"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = TreeSelect;

var _element = require("@wordpress/element");

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _lodash = require("lodash");

var _ = require("../");

/**
 * External dependencies
 */

/**
 * WordPress dependencies
 */

/**
 * Internal dependencies
 */
function getSelectOptions(tree, level = 0) {
  return (0, _lodash.flatMap)(tree, treeNode => [{
    value: treeNode.id,
    label: (0, _lodash.repeat)('\u00A0', level * 3) + (0, _lodash.unescape)(treeNode.name)
  }, ...getSelectOptions(treeNode.children || [], level + 1)]);
}

function TreeSelect({
  label,
  noOptionLabel,
  onChange,
  selectedId,
  tree,
  ...props
}) {
  const options = (0, _element.useMemo)(() => {
    return (0, _lodash.compact)([noOptionLabel && {
      value: '',
      label: noOptionLabel
    }, ...getSelectOptions(tree)]);
  }, [noOptionLabel, tree]);
  return (0, _element.createElement)(_.SelectControl, (0, _extends2.default)({
    label,
    options,
    onChange,
    value: selectedId
  }, props));
}
//# sourceMappingURL=index.js.map