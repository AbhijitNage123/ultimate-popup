{"version":3,"sources":["@wordpress/components/src/modal/index.js"],"names":["parentElement","openModalCount","Modal","Component","constructor","props","prepareDOM","componentDidMount","openFirstModal","componentWillUnmount","closeLastModal","cleanDOM","document","createElement","body","appendChild","node","removeChild","ariaHelper","hideApp","classList","add","bodyOpenClassName","remove","showApp","render","onRequestClose","title","icon","closeButtonLabel","children","aria","instanceId","isDismissible","isDismissable","otherProps","headingId","labelledby","since","alternative","describedby","defaultProps","role","focusOnMount","shouldCloseOnEsc","shouldCloseOnClickOutside"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Component, createPortal } from '@wordpress/element';\nimport { withInstanceId } from '@wordpress/compose';\nimport deprecated from '@wordpress/deprecated';\n\n/**\n * Internal dependencies\n */\nimport ModalFrame from './frame';\nimport ModalHeader from './header';\nimport * as ariaHelper from './aria-helper';\n\n// Used to count the number of open modals.\nlet parentElement,\n\topenModalCount = 0;\n\nclass Modal extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\t\tthis.prepareDOM();\n\t}\n\n\t/**\n\t * Appends the modal's node to the DOM, so the portal can render the\n\t * modal in it. Also calls the openFirstModal when this is the first modal to be\n\t * opened.\n\t */\n\tcomponentDidMount() {\n\t\topenModalCount++;\n\n\t\tif ( openModalCount === 1 ) {\n\t\t\tthis.openFirstModal();\n\t\t}\n\t}\n\n\t/**\n\t * Removes the modal's node from the DOM. Also calls closeLastModal when this is\n\t * the last modal to be closed.\n\t */\n\tcomponentWillUnmount() {\n\t\topenModalCount--;\n\n\t\tif ( openModalCount === 0 ) {\n\t\t\tthis.closeLastModal();\n\t\t}\n\n\t\tthis.cleanDOM();\n\t}\n\n\t/**\n\t * Prepares the DOM for the modals to be rendered.\n\t *\n\t * Every modal is mounted in a separate div appended to a parent div\n\t * that is appended to the document body.\n\t *\n\t * The parent div will be created if it does not yet exist, and the\n\t * separate div for this specific modal will be appended to that.\n\t */\n\tprepareDOM() {\n\t\tif ( ! parentElement ) {\n\t\t\tparentElement = document.createElement( 'div' );\n\t\t\tdocument.body.appendChild( parentElement );\n\t\t}\n\t\tthis.node = document.createElement( 'div' );\n\t\tparentElement.appendChild( this.node );\n\t}\n\n\t/**\n\t * Removes the specific mounting point for this modal from the DOM.\n\t */\n\tcleanDOM() {\n\t\tparentElement.removeChild( this.node );\n\t}\n\n\t/**\n\t * Prepares the DOM for this modal and any additional modal to be mounted.\n\t *\n\t * It appends an additional div to the body for the modals to be rendered in,\n\t * it hides any other elements from screen-readers and adds an additional class\n\t * to the body to prevent scrolling while the modal is open.\n\t */\n\topenFirstModal() {\n\t\tariaHelper.hideApp( parentElement );\n\t\tdocument.body.classList.add( this.props.bodyOpenClassName );\n\t}\n\n\t/**\n\t * Cleans up the DOM after the last modal is closed and makes the app available\n\t * for screen-readers again.\n\t */\n\tcloseLastModal() {\n\t\tdocument.body.classList.remove( this.props.bodyOpenClassName );\n\t\tariaHelper.showApp();\n\t}\n\n\t/**\n\t * Renders the modal.\n\t *\n\t * @return {WPElement} The modal element.\n\t */\n\trender() {\n\t\tconst {\n\t\t\tonRequestClose,\n\t\t\ttitle,\n\t\t\ticon,\n\t\t\tcloseButtonLabel,\n\t\t\tchildren,\n\t\t\taria,\n\t\t\tinstanceId,\n\t\t\tisDismissible,\n\t\t\tisDismissable, //Deprecated\n\t\t\t// Many of the documented props for Modal are passed straight through\n\t\t\t// to the ModalFrame component and handled there.\n\t\t\t...otherProps\n\t\t} = this.props;\n\n\t\tconst headingId = title\n\t\t\t? `components-modal-header-${ instanceId }`\n\t\t\t: aria.labelledby;\n\n\t\tif ( isDismissable ) {\n\t\t\tdeprecated( 'isDismissable prop of the Modal component', {\n\t\t\t\tsince: '5.4',\n\t\t\t\talternative:\n\t\t\t\t\t'isDismissible prop (renamed) of the Modal component',\n\t\t\t} );\n\t\t}\n\t\t// Disable reason: this stops mouse events from triggering tooltips and\n\t\t// other elements underneath the modal overlay.\n\t\treturn createPortal(\n\t\t\t<ModalFrame\n\t\t\t\tonRequestClose={ onRequestClose }\n\t\t\t\taria={ {\n\t\t\t\t\tlabelledby: headingId,\n\t\t\t\t\tdescribedby: aria.describedby,\n\t\t\t\t} }\n\t\t\t\t{ ...otherProps }\n\t\t\t>\n\t\t\t\t<div className={ 'components-modal__content' } role=\"document\">\n\t\t\t\t\t<ModalHeader\n\t\t\t\t\t\tcloseLabel={ closeButtonLabel }\n\t\t\t\t\t\theadingId={ title && headingId }\n\t\t\t\t\t\ticon={ icon }\n\t\t\t\t\t\tisDismissible={ isDismissible || isDismissable }\n\t\t\t\t\t\tonClose={ onRequestClose }\n\t\t\t\t\t\ttitle={ title }\n\t\t\t\t\t/>\n\t\t\t\t\t{ children }\n\t\t\t\t</div>\n\t\t\t</ModalFrame>,\n\t\t\tthis.node\n\t\t);\n\t}\n}\n\nModal.defaultProps = {\n\tbodyOpenClassName: 'modal-open',\n\trole: 'dialog',\n\ttitle: null,\n\tfocusOnMount: true,\n\tshouldCloseOnEsc: true,\n\tshouldCloseOnClickOutside: true,\n\tisDismissible: true,\n\t/* accessibility */\n\taria: {\n\t\tlabelledby: null,\n\t\tdescribedby: null,\n\t},\n};\n\nexport default withInstanceId( Modal );\n"]}