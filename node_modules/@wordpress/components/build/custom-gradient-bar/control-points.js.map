{"version":3,"sources":["@wordpress/components/src/custom-gradient-bar/control-points.js"],"names":["ControlPointKeyboardMove","value","position","onChange","children","shortcuts","right","event","stopPropagation","newPosition","KEYBOARD_CONTROL_POINT_VARIATION","left","ControlPointButton","isOpen","color","additionalProps","instanceId","descriptionId","ControlPoints","disableRemove","disableAlpha","gradientPickerDomRef","ignoreMarkerPosition","controlPoints","onStartControlPointChange","onStopControlPointChange","controlPointMoveState","onMouseMove","relativePosition","clientX","current","GRADIENT_MARKERS_WIDTH","initialPosition","index","significantMoveHappened","Math","abs","MINIMUM_SIGNIFICANT_MOVE","cleanEventListeners","window","removeEventListener","listenersActivated","map","point","onToggle","addEventListener","onClose","toRgbString","COLOR_POPOVER_PROPS","InsertPoint","onOpenInserter","onCloseInserter","insertPosition","alreadyInsertedPoint","setAlreadyInsertedPoint","plus","undefined"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { useInstanceId } from '@wordpress/compose';\nimport { useEffect, useRef, useState } from '@wordpress/element';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { plus } from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport Button from '../button';\nimport ColorPicker from '../color-picker';\nimport Dropdown from '../dropdown';\nimport KeyboardShortcuts from '../keyboard-shortcuts';\nimport VisuallyHidden from '../visually-hidden';\n\nimport {\n\taddControlPoint,\n\tclampPercent,\n\tremoveControlPoint,\n\tupdateControlPointColor,\n\tupdateControlPointColorByPosition,\n\tupdateControlPointPosition,\n\tgetHorizontalRelativeGradientPosition,\n} from './utils';\nimport {\n\tCOLOR_POPOVER_PROPS,\n\tGRADIENT_MARKERS_WIDTH,\n\tMINIMUM_SIGNIFICANT_MOVE,\n\tKEYBOARD_CONTROL_POINT_VARIATION,\n} from './constants';\n\nfunction ControlPointKeyboardMove( { value: position, onChange, children } ) {\n\tconst shortcuts = {\n\t\tright( event ) {\n\t\t\t// Stop propagation of the key press event to avoid focus moving\n\t\t\t// to another editor area.\n\t\t\tevent.stopPropagation();\n\t\t\tconst newPosition = clampPercent(\n\t\t\t\tposition + KEYBOARD_CONTROL_POINT_VARIATION\n\t\t\t);\n\t\t\tonChange( newPosition );\n\t\t},\n\t\tleft( event ) {\n\t\t\t// Stop propagation of the key press event to avoid focus moving\n\t\t\t// to another editor area.\n\t\t\tevent.stopPropagation();\n\t\t\tconst newPosition = clampPercent(\n\t\t\t\tposition - KEYBOARD_CONTROL_POINT_VARIATION\n\t\t\t);\n\t\t\tonChange( newPosition );\n\t\t},\n\t};\n\n\treturn (\n\t\t<KeyboardShortcuts shortcuts={ shortcuts }>\n\t\t\t{ children }\n\t\t</KeyboardShortcuts>\n\t);\n}\n\nfunction ControlPointButton( {\n\tisOpen,\n\tposition,\n\tcolor,\n\tonChange,\n\t...additionalProps\n} ) {\n\tconst instanceId = useInstanceId( ControlPointButton );\n\tconst descriptionId = `components-custom-gradient-picker__control-point-button-description-${ instanceId }`;\n\treturn (\n\t\t<ControlPointKeyboardMove value={ position } onChange={ onChange }>\n\t\t\t<Button\n\t\t\t\taria-label={ sprintf(\n\t\t\t\t\t// translators: %1$s: gradient position e.g: 70, %2$s: gradient color code e.g: rgb(52,121,151).\n\t\t\t\t\t__(\n\t\t\t\t\t\t'Gradient control point at position %1$s%% with color code %2$s.'\n\t\t\t\t\t),\n\t\t\t\t\tposition,\n\t\t\t\t\tcolor\n\t\t\t\t) }\n\t\t\t\taria-describedby={ descriptionId }\n\t\t\t\taria-haspopup=\"true\"\n\t\t\t\taria-expanded={ isOpen }\n\t\t\t\tclassName={ classnames(\n\t\t\t\t\t'components-custom-gradient-picker__control-point-button',\n\t\t\t\t\t{\n\t\t\t\t\t\t'is-active': isOpen,\n\t\t\t\t\t}\n\t\t\t\t) }\n\t\t\t\tstyle={ {\n\t\t\t\t\tleft: `${ position }%`,\n\t\t\t\t} }\n\t\t\t\t{ ...additionalProps }\n\t\t\t/>\n\t\t\t<VisuallyHidden id={ descriptionId }>\n\t\t\t\t{ __(\n\t\t\t\t\t'Use your left or right arrow keys or drag and drop with the mouse to change the gradient position. Press the button to change the color or remove the control point.'\n\t\t\t\t) }\n\t\t\t</VisuallyHidden>\n\t\t</ControlPointKeyboardMove>\n\t);\n}\n\nfunction ControlPoints( {\n\tdisableRemove,\n\tdisableAlpha,\n\tgradientPickerDomRef,\n\tignoreMarkerPosition,\n\tvalue: controlPoints,\n\tonChange,\n\tonStartControlPointChange,\n\tonStopControlPointChange,\n} ) {\n\tconst controlPointMoveState = useRef();\n\n\tconst onMouseMove = ( event ) => {\n\t\tconst relativePosition = getHorizontalRelativeGradientPosition(\n\t\t\tevent.clientX,\n\t\t\tgradientPickerDomRef.current,\n\t\t\tGRADIENT_MARKERS_WIDTH\n\t\t);\n\t\tconst {\n\t\t\tinitialPosition,\n\t\t\tindex,\n\t\t\tsignificantMoveHappened,\n\t\t} = controlPointMoveState.current;\n\t\tif (\n\t\t\t! significantMoveHappened &&\n\t\t\tMath.abs( initialPosition - relativePosition ) >=\n\t\t\t\tMINIMUM_SIGNIFICANT_MOVE\n\t\t) {\n\t\t\tcontrolPointMoveState.current.significantMoveHappened = true;\n\t\t}\n\n\t\tonChange(\n\t\t\tupdateControlPointPosition( controlPoints, index, relativePosition )\n\t\t);\n\t};\n\n\tconst cleanEventListeners = () => {\n\t\tif (\n\t\t\twindow &&\n\t\t\twindow.removeEventListener &&\n\t\t\tcontrolPointMoveState.current &&\n\t\t\tcontrolPointMoveState.current.listenersActivated\n\t\t) {\n\t\t\twindow.removeEventListener( 'mousemove', onMouseMove );\n\t\t\twindow.removeEventListener( 'mouseup', cleanEventListeners );\n\t\t\tonStopControlPointChange();\n\t\t\tcontrolPointMoveState.current.listenersActivated = false;\n\t\t}\n\t};\n\n\tuseEffect( () => {\n\t\treturn () => {\n\t\t\tcleanEventListeners();\n\t\t};\n\t}, [] );\n\n\treturn controlPoints.map( ( point, index ) => {\n\t\tconst initialPosition = point?.position;\n\t\treturn (\n\t\t\tignoreMarkerPosition !== initialPosition && (\n\t\t\t\t<Dropdown\n\t\t\t\t\tkey={ index }\n\t\t\t\t\tonClose={ onStopControlPointChange }\n\t\t\t\t\trenderToggle={ ( { isOpen, onToggle } ) => (\n\t\t\t\t\t\t<ControlPointButton\n\t\t\t\t\t\t\tkey={ index }\n\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tcontrolPointMoveState.current &&\n\t\t\t\t\t\t\t\t\tcontrolPointMoveState.current\n\t\t\t\t\t\t\t\t\t\t.significantMoveHappened\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ( isOpen ) {\n\t\t\t\t\t\t\t\t\tonStopControlPointChange();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tonStartControlPointChange();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tonToggle();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\tonMouseDown={ () => {\n\t\t\t\t\t\t\t\tif ( window && window.addEventListener ) {\n\t\t\t\t\t\t\t\t\tcontrolPointMoveState.current = {\n\t\t\t\t\t\t\t\t\t\tinitialPosition,\n\t\t\t\t\t\t\t\t\t\tindex,\n\t\t\t\t\t\t\t\t\t\tsignificantMoveHappened: false,\n\t\t\t\t\t\t\t\t\t\tlistenersActivated: true,\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\tonStartControlPointChange();\n\t\t\t\t\t\t\t\t\twindow.addEventListener(\n\t\t\t\t\t\t\t\t\t\t'mousemove',\n\t\t\t\t\t\t\t\t\t\tonMouseMove\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\twindow.addEventListener(\n\t\t\t\t\t\t\t\t\t\t'mouseup',\n\t\t\t\t\t\t\t\t\t\tcleanEventListeners\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\tisOpen={ isOpen }\n\t\t\t\t\t\t\tposition={ point.position }\n\t\t\t\t\t\t\tcolor={ point.color }\n\t\t\t\t\t\t\tonChange={ ( newPosition ) => {\n\t\t\t\t\t\t\t\tonChange(\n\t\t\t\t\t\t\t\t\tupdateControlPointPosition(\n\t\t\t\t\t\t\t\t\t\tcontrolPoints,\n\t\t\t\t\t\t\t\t\t\tindex,\n\t\t\t\t\t\t\t\t\t\tnewPosition\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\trenderContent={ ( { onClose } ) => (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<ColorPicker\n\t\t\t\t\t\t\t\tdisableAlpha={ disableAlpha }\n\t\t\t\t\t\t\t\tcolor={ point.color }\n\t\t\t\t\t\t\t\tonChangeComplete={ ( { color } ) => {\n\t\t\t\t\t\t\t\t\tonChange(\n\t\t\t\t\t\t\t\t\t\tupdateControlPointColor(\n\t\t\t\t\t\t\t\t\t\t\tcontrolPoints,\n\t\t\t\t\t\t\t\t\t\t\tindex,\n\t\t\t\t\t\t\t\t\t\t\tcolor.toRgbString()\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{ ! disableRemove && (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tclassName=\"components-custom-gradient-picker__remove-control-point\"\n\t\t\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\t\t\tonChange(\n\t\t\t\t\t\t\t\t\t\t\tremoveControlPoint(\n\t\t\t\t\t\t\t\t\t\t\t\tcontrolPoints,\n\t\t\t\t\t\t\t\t\t\t\t\tindex\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\tvariant=\"link\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ __( 'Remove Control Point' ) }\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</>\n\t\t\t\t\t) }\n\t\t\t\t\tpopoverProps={ COLOR_POPOVER_PROPS }\n\t\t\t\t/>\n\t\t\t)\n\t\t);\n\t} );\n}\n\nfunction InsertPoint( {\n\tvalue: controlPoints,\n\tonChange,\n\tonOpenInserter,\n\tonCloseInserter,\n\tinsertPosition,\n\tdisableAlpha,\n} ) {\n\tconst [ alreadyInsertedPoint, setAlreadyInsertedPoint ] = useState( false );\n\treturn (\n\t\t<Dropdown\n\t\t\tclassName=\"components-custom-gradient-picker__inserter\"\n\t\t\tonClose={ () => {\n\t\t\t\tonCloseInserter();\n\t\t\t} }\n\t\t\trenderToggle={ ( { isOpen, onToggle } ) => (\n\t\t\t\t<Button\n\t\t\t\t\taria-expanded={ isOpen }\n\t\t\t\t\taria-haspopup=\"true\"\n\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\tif ( isOpen ) {\n\t\t\t\t\t\t\tonCloseInserter();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetAlreadyInsertedPoint( false );\n\t\t\t\t\t\t\tonOpenInserter();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonToggle();\n\t\t\t\t\t} }\n\t\t\t\t\tclassName=\"components-custom-gradient-picker__insert-point\"\n\t\t\t\t\ticon={ plus }\n\t\t\t\t\tstyle={ {\n\t\t\t\t\t\tleft:\n\t\t\t\t\t\t\tinsertPosition !== null\n\t\t\t\t\t\t\t\t? `${ insertPosition }%`\n\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t) }\n\t\t\trenderContent={ () => (\n\t\t\t\t<ColorPicker\n\t\t\t\t\tdisableAlpha={ disableAlpha }\n\t\t\t\t\tonChangeComplete={ ( { color } ) => {\n\t\t\t\t\t\tif ( ! alreadyInsertedPoint ) {\n\t\t\t\t\t\t\tonChange(\n\t\t\t\t\t\t\t\taddControlPoint(\n\t\t\t\t\t\t\t\t\tcontrolPoints,\n\t\t\t\t\t\t\t\t\tinsertPosition,\n\t\t\t\t\t\t\t\t\tcolor.toRgbString()\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tsetAlreadyInsertedPoint( true );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tonChange(\n\t\t\t\t\t\t\t\tupdateControlPointColorByPosition(\n\t\t\t\t\t\t\t\t\tcontrolPoints,\n\t\t\t\t\t\t\t\t\tinsertPosition,\n\t\t\t\t\t\t\t\t\tcolor.toRgbString()\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t) }\n\t\t\tpopoverProps={ COLOR_POPOVER_PROPS }\n\t\t/>\n\t);\n}\nControlPoints.InsertPoint = InsertPoint;\n\nexport default ControlPoints;\n"]}