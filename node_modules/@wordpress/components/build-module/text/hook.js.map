{"version":3,"sources":["@wordpress/components/src/text/hook.js"],"names":["css","cx","isPlainObject","useMemo","Children","cloneElement","hasConnectNamespace","useContextSystem","useTruncate","getOptimalTextShade","styles","createHighlighterText","getFontSize","CONFIG","COLORS","getLineHeight","useText","props","adjustLineHeightForInnerControls","align","children","className","color","ellipsizeMode","isDestructive","display","highlightEscape","highlightCaseSensitive","highlightWords","highlightSanitize","isBlock","letterSpacing","lineHeight","lineHeightProp","optimizeReadabilityFor","size","truncate","upperCase","variant","weight","fontWeight","otherProps","content","isHighlighter","Array","isArray","isCaption","TypeError","autoEscape","caseSensitive","searchWords","sanitize","classes","sx","Base","fontSize","textAlign","optimalTextColor","isOptimalTextColorDark","black","white","Text","destructive","highlighterText","block","muted","finalEllipsizeMode","finalComponentProps","truncateProps","map","child","isLink"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\n// Disable reason: Temporarily disable for existing usages\n// until we remove them as part of https://github.com/WordPress/gutenberg/issues/30503#deprecating-emotion-css\n// eslint-disable-next-line no-restricted-imports\nimport { css, cx } from '@emotion/css';\nimport { isPlainObject } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { useMemo, Children, cloneElement } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { hasConnectNamespace, useContextSystem } from '../ui/context';\nimport { useTruncate } from '../truncate';\nimport { getOptimalTextShade } from '../ui/utils';\nimport * as styles from './styles';\nimport { createHighlighterText } from './utils';\nimport { getFontSize } from '../ui/utils/font-size';\nimport { CONFIG, COLORS } from '../utils';\nimport { getLineHeight } from './get-line-height';\n\n/**\n * @param {import('../ui/context').PolymorphicComponentProps<import('./types').Props, 'span'>} props\n */\nexport default function useText( props ) {\n\tconst {\n\t\tadjustLineHeightForInnerControls,\n\t\talign,\n\t\tchildren,\n\t\tclassName,\n\t\tcolor,\n\t\tellipsizeMode,\n\t\tisDestructive = false,\n\t\tdisplay,\n\t\thighlightEscape = false,\n\t\thighlightCaseSensitive = false,\n\t\thighlightWords,\n\t\thighlightSanitize,\n\t\tisBlock = false,\n\t\tletterSpacing,\n\t\tlineHeight: lineHeightProp,\n\t\toptimizeReadabilityFor,\n\t\tsize,\n\t\ttruncate = false,\n\t\tupperCase = false,\n\t\tvariant,\n\t\tweight = CONFIG.fontWeight,\n\t\t...otherProps\n\t} = useContextSystem( props, 'Text' );\n\n\t/** @type {import('react').ReactNode} */\n\tlet content = children;\n\tconst isHighlighter = Array.isArray( highlightWords );\n\tconst isCaption = size === 'caption';\n\n\tif ( isHighlighter ) {\n\t\tif ( typeof children !== 'string' ) {\n\t\t\tthrow new TypeError(\n\t\t\t\t'`children` of `Text` must only be `string` types when `highlightWords` is defined'\n\t\t\t);\n\t\t}\n\n\t\tcontent = createHighlighterText( {\n\t\t\tautoEscape: highlightEscape,\n\t\t\t// Disable reason: We need to disable this otherwise it erases the cast\n\t\t\t// eslint-disable-next-line object-shorthand\n\t\t\tchildren: /** @type {string} */ ( children ),\n\t\t\tcaseSensitive: highlightCaseSensitive,\n\t\t\tsearchWords: highlightWords,\n\t\t\tsanitize: highlightSanitize,\n\t\t} );\n\t}\n\n\tconst classes = useMemo( () => {\n\t\tconst sx = {};\n\n\t\tconst lineHeight = getLineHeight(\n\t\t\tadjustLineHeightForInnerControls,\n\t\t\tlineHeightProp\n\t\t);\n\n\t\tsx.Base = css( {\n\t\t\tcolor,\n\t\t\tdisplay,\n\t\t\tfontSize: getFontSize( size ),\n\t\t\t/* eslint-disable jsdoc/valid-types */\n\t\t\tfontWeight: /** @type {import('react').CSSProperties['fontWeight']} */ ( weight ),\n\t\t\t/* eslint-enable jsdoc/valid-types */\n\t\t\tlineHeight,\n\t\t\tletterSpacing,\n\t\t\ttextAlign: align,\n\t\t} );\n\n\t\tsx.upperCase = css( { textTransform: 'uppercase' } );\n\n\t\tsx.optimalTextColor = null;\n\n\t\tif ( optimizeReadabilityFor ) {\n\t\t\tconst isOptimalTextColorDark =\n\t\t\t\tgetOptimalTextShade( optimizeReadabilityFor ) === 'dark';\n\n\t\t\tsx.optimalTextColor = isOptimalTextColorDark\n\t\t\t\t? css( { color: COLORS.black } )\n\t\t\t\t: css( { color: COLORS.white } );\n\t\t}\n\n\t\treturn cx(\n\t\t\tstyles.Text,\n\t\t\tsx.Base,\n\t\t\tsx.optimalTextColor,\n\t\t\tisDestructive && styles.destructive,\n\t\t\t!! isHighlighter && styles.highlighterText,\n\t\t\tisBlock && styles.block,\n\t\t\tisCaption && styles.muted,\n\t\t\tvariant && styles[ variant ],\n\t\t\tupperCase && sx.upperCase,\n\t\t\tclassName\n\t\t);\n\t}, [\n\t\tadjustLineHeightForInnerControls,\n\t\talign,\n\t\tclassName,\n\t\tcolor,\n\t\tdisplay,\n\t\tisBlock,\n\t\tisCaption,\n\t\tisDestructive,\n\t\tisHighlighter,\n\t\tletterSpacing,\n\t\tlineHeightProp,\n\t\toptimizeReadabilityFor,\n\t\tsize,\n\t\tupperCase,\n\t\tvariant,\n\t\tweight,\n\t] );\n\n\t/** @type {undefined | 'auto' | 'none'} */\n\tlet finalEllipsizeMode;\n\tif ( truncate === true ) {\n\t\tfinalEllipsizeMode = 'auto';\n\t}\n\tif ( truncate === false ) {\n\t\tfinalEllipsizeMode = 'none';\n\t}\n\n\tconst finalComponentProps = {\n\t\t...otherProps,\n\t\tclassName: classes,\n\t\tchildren,\n\t\tellipsizeMode: ellipsizeMode || finalEllipsizeMode,\n\t};\n\n\tconst truncateProps = useTruncate( finalComponentProps );\n\n\t/**\n\t * Enhance child `<Link />` components to inherit font size.\n\t */\n\tif ( ! truncate && Array.isArray( children ) ) {\n\t\tcontent = Children.map( children, ( child ) => {\n\t\t\t// @ts-ignore\n\t\t\tif ( ! isPlainObject( child ) || ! ( 'props' in child ) ) {\n\t\t\t\treturn child;\n\t\t\t}\n\n\t\t\tconst isLink = hasConnectNamespace( child, [ 'Link' ] );\n\t\t\tif ( isLink ) {\n\t\t\t\treturn cloneElement( child, {\n\t\t\t\t\tsize: child.props.size || 'inherit',\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\treturn child;\n\t\t} );\n\t}\n\n\treturn {\n\t\t...truncateProps,\n\t\tchildren: truncate ? truncateProps.children : content,\n\t};\n}\n"]}