{"version":3,"sources":["@wordpress/block-editor/src/components/floating-toolbar/index.native.js"],"names":["Animated","Easing","View","Platform","ToolbarButton","ToolbarGroup","useEffect","useState","useRef","withSelect","withDispatch","compose","__","styles","NavigateUpSVG","BlockSelectionButton","store","blockEditorStore","EASE_IN_DURATION","EASE_OUT_DURATION","TRANSLATION_RANGE","FloatingToolbar","selectedClientId","parentId","showFloatingToolbar","onNavigateUp","isRTL","opacity","Value","current","previousSelection","setPreviousSelection","timing","toValue","duration","easing","ease","useNativeDriver","start","clientId","translationRange","OS","translation","interpolate","inputRange","outputRange","animationStyle","transform","translateY","previousSelectedClientId","previousSelectedParentId","showPrevious","blockSelectionButtonClientId","showNavUpButton","floatingToolbar","toolbar","pipe","select","getSelectedBlockClientId","getBlockHierarchyRootClientId","getBlockRootClientId","getBlockCount","getSettings","rootBlockId","dispatch","selectBlock","initialPosition"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { Animated, Easing, View, Platform } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { ToolbarButton, ToolbarGroup } from '@wordpress/components';\nimport { useEffect, useState, useRef } from '@wordpress/element';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport styles from './styles.scss';\nimport NavigateUpSVG from './nav-up-icon';\nimport BlockSelectionButton from '../block-list/block-selection-button.native';\nimport { store as blockEditorStore } from '../../store';\n\nconst EASE_IN_DURATION = 250;\nconst EASE_OUT_DURATION = 80;\nconst TRANSLATION_RANGE = 8;\n\nconst FloatingToolbar = ( {\n\tselectedClientId,\n\tparentId,\n\tshowFloatingToolbar,\n\tonNavigateUp,\n\tisRTL,\n} ) => {\n\tconst opacity = useRef( new Animated.Value( 0 ) ).current;\n\t// Sustain old selection for proper block selection button rendering when exit animation is ongoing.\n\tconst [ previousSelection, setPreviousSelection ] = useState( {} );\n\n\tuseEffect( () => {\n\t\tAnimated.timing( opacity, {\n\t\t\ttoValue: showFloatingToolbar ? 1 : 0,\n\t\t\tduration: showFloatingToolbar\n\t\t\t\t? EASE_IN_DURATION\n\t\t\t\t: EASE_OUT_DURATION,\n\t\t\teasing: Easing.ease,\n\t\t\tuseNativeDriver: true,\n\t\t} ).start();\n\t}, [ showFloatingToolbar ] );\n\n\tuseEffect( () => {\n\t\tif ( showFloatingToolbar )\n\t\t\tsetPreviousSelection( { clientId: selectedClientId, parentId } );\n\t}, [ selectedClientId ] );\n\n\tconst translationRange =\n\t\t( Platform.OS === 'android' ? -1 : 1 ) * TRANSLATION_RANGE;\n\n\tconst translation = opacity.interpolate( {\n\t\tinputRange: [ 0, 1 ],\n\t\toutputRange: [ translationRange, 0 ],\n\t} );\n\n\tconst animationStyle = {\n\t\topacity,\n\t\ttransform: [ { translateY: translation } ],\n\t};\n\n\tconst {\n\t\tclientId: previousSelectedClientId,\n\t\tparentId: previousSelectedParentId,\n\t} = previousSelection;\n\n\tconst showPrevious = previousSelectedClientId && ! showFloatingToolbar;\n\tconst blockSelectionButtonClientId = showPrevious\n\t\t? previousSelectedClientId\n\t\t: selectedClientId;\n\tconst showNavUpButton =\n\t\t!! parentId || ( showPrevious && !! previousSelectedParentId );\n\n\treturn (\n\t\t!! opacity && (\n\t\t\t<Animated.View\n\t\t\t\tstyle={ [ styles.floatingToolbar, animationStyle ] }\n\t\t\t\tpointerEvents={ showFloatingToolbar ? 'auto' : 'none' }\n\t\t\t>\n\t\t\t\t{ showNavUpButton && (\n\t\t\t\t\t<ToolbarGroup passedStyle={ styles.toolbar }>\n\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\ttitle={ __( 'Navigate Up' ) }\n\t\t\t\t\t\t\tonClick={\n\t\t\t\t\t\t\t\t! showPrevious &&\n\t\t\t\t\t\t\t\t( () => onNavigateUp( parentId ) )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ticon={ <NavigateUpSVG isRTL={ isRTL } /> }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<View style={ styles.pipe } />\n\t\t\t\t\t</ToolbarGroup>\n\t\t\t\t) }\n\t\t\t\t<BlockSelectionButton\n\t\t\t\t\tclientId={ blockSelectionButtonClientId }\n\t\t\t\t/>\n\t\t\t</Animated.View>\n\t\t)\n\t);\n};\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst {\n\t\t\tgetSelectedBlockClientId,\n\t\t\tgetBlockHierarchyRootClientId,\n\t\t\tgetBlockRootClientId,\n\t\t\tgetBlockCount,\n\t\t\tgetSettings,\n\t\t} = select( blockEditorStore );\n\n\t\tconst selectedClientId = getSelectedBlockClientId();\n\n\t\tif ( ! selectedClientId ) return;\n\n\t\tconst rootBlockId = getBlockHierarchyRootClientId( selectedClientId );\n\n\t\treturn {\n\t\t\tselectedClientId,\n\t\t\tshowFloatingToolbar: !! getBlockCount( rootBlockId ),\n\t\t\tparentId: getBlockRootClientId( selectedClientId ),\n\t\t\tisRTL: getSettings().isRTL,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { selectBlock } = dispatch( blockEditorStore );\n\n\t\treturn {\n\t\t\tonNavigateUp( clientId, initialPosition ) {\n\t\t\t\tselectBlock( clientId, initialPosition );\n\t\t\t},\n\t\t};\n\t} ),\n] )( FloatingToolbar );\n"]}