{"version":3,"sources":["@wordpress/block-editor/src/components/video-player/index.native.js"],"names":["Component","Icon","__","View","TouchableOpacity","Platform","Linking","Alert","default","VideoPlayer","styles","PlayIcon","VIDEO_ASPECT_RATIO","Video","constructor","arguments","isIOS","OS","state","isFullScreen","videoContainerHeight","onPressPlay","bind","onVideoLayout","event","height","nativeEvent","layout","setState","player","presentFullscreenPlayer","source","props","uri","openURL","url","canOpenURL","then","supported","alert","window","console","warn","catch","err","error","render","isSelected","style","showPlayButton","videoContainer","ref","overlayContainer","blackOverlay","playIcon","size"],"mappings":";;;AAAA;AACA;AACA;AACA,SAASA,SAAT,QAA0B,oBAA1B;AACA,SAASC,IAAT,QAAqB,uBAArB;AACA,SAASC,EAAT,QAAmB,iBAAnB;AAEA;AACA;AACA;;AACA,SAASC,IAAT,EAAeC,gBAAf,EAAiCC,QAAjC,EAA2CC,OAA3C,EAAoDC,KAApD,QAAiE,cAAjE;AACA,SAASC,OAAO,IAAIC,WAApB,QAAuC,oBAAvC;AAEA;AACA;AACA;;AACA,OAAOC,MAAP,MAAmB,eAAnB;AACA,OAAOC,QAAP,MAAqB,iBAArB,C,CAEA;;AACA,OAAO,MAAMC,kBAAkB,GAAG,KAAK,CAAhC;;AAEP,MAAMC,KAAN,SAAoBb,SAApB,CAA8B;AAC7Bc,EAAAA,WAAW,GAAG;AACb,UAAO,GAAGC,SAAV;AACA,SAAKC,KAAL,GAAaX,QAAQ,CAACY,EAAT,KAAgB,KAA7B;AACA,SAAKC,KAAL,GAAa;AACZC,MAAAA,YAAY,EAAE,KADF;AAEZC,MAAAA,oBAAoB,EAAE;AAFV,KAAb;AAIA,SAAKC,WAAL,GAAmB,KAAKA,WAAL,CAAiBC,IAAjB,CAAuB,IAAvB,CAAnB;AACA,SAAKC,aAAL,GAAqB,KAAKA,aAAL,CAAmBD,IAAnB,CAAyB,IAAzB,CAArB;AACA;;AAEDC,EAAAA,aAAa,CAAEC,KAAF,EAAU;AACtB,UAAM;AAAEC,MAAAA;AAAF,QAAaD,KAAK,CAACE,WAAN,CAAkBC,MAArC;;AACA,QAAKF,MAAM,KAAK,KAAKP,KAAL,CAAWE,oBAA3B,EAAkD;AACjD,WAAKQ,QAAL,CAAe;AAAER,QAAAA,oBAAoB,EAAEK;AAAxB,OAAf;AACA;AACD;;AAEDJ,EAAAA,WAAW,GAAG;AACb,QAAK,KAAKL,KAAV,EAAkB;AACjB,UAAK,KAAKa,MAAV,EAAmB;AAClB,aAAKA,MAAL,CAAYC,uBAAZ;AACA;AACD,KAJD,MAIO;AACN,YAAM;AAAEC,QAAAA;AAAF,UAAa,KAAKC,KAAxB;;AACA,UAAKD,MAAM,IAAIA,MAAM,CAACE,GAAtB,EAA4B;AAC3B,aAAKC,OAAL,CAAcH,MAAM,CAACE,GAArB;AACA;AACD;AACD,GA9B4B,CAgC7B;;;AACAC,EAAAA,OAAO,CAAEC,GAAF,EAAQ;AACd7B,IAAAA,OAAO,CAAC8B,UAAR,CAAoBD,GAApB,EACEE,IADF,CACUC,SAAF,IAAiB;AACvB,UAAK,CAAEA,SAAP,EAAmB;AAClB/B,QAAAA,KAAK,CAACgC,KAAN,CACCrC,EAAE,CAAE,2BAAF,CADH,EAECA,EAAE,CACD,uEADC,CAFH;AAMAsC,QAAAA,MAAM,CAACC,OAAP,CAAeC,IAAf,CACC,4DACCP,GAFF;AAIA,OAXD,MAWO;AACN,eAAO7B,OAAO,CAAC4B,OAAR,CAAiBC,GAAjB,CAAP;AACA;AACD,KAhBF,EAiBEQ,KAjBF,CAiBWC,GAAF,IAAW;AAClBrC,MAAAA,KAAK,CAACgC,KAAN,CACCrC,EAAE,CAAE,2BAAF,CADH,EAECA,EAAE,CAAE,8CAAF,CAFH;AAIAsC,MAAAA,MAAM,CAACC,OAAP,CAAeI,KAAf,CACC,oDAAoDV,GADrD,EAECS,GAFD;AAIA,KA1BF;AA2BA;;AAEDE,EAAAA,MAAM,GAAG;AACR,UAAM;AAAEC,MAAAA,UAAF;AAAcC,MAAAA;AAAd,QAAwB,KAAKhB,KAAnC;AACA,UAAM;AAAEb,MAAAA,YAAF;AAAgBC,MAAAA;AAAhB,QAAyC,KAAKF,KAApD;AACA,UAAM+B,cAAc,GAAG7B,oBAAoB,GAAG,CAA9C;AAEA,WACC,cAAC,IAAD;AAAM,MAAA,KAAK,EAAGV,MAAM,CAACwC;AAArB,OACC,cAAC,WAAD,eACM,KAAKlB,KADX;AAEC,MAAA,GAAG,EAAKmB,GAAF,IAAW;AAChB,aAAKtB,MAAL,GAAcsB,GAAd;AACA,OAJF,CAKC;AACA;AACA;AAPD;AAQC,MAAA,QAAQ,EAAG,KARZ;AASC,MAAA,kBAAkB,EAAG,QATtB;AAUC,MAAA,MAAM,EAAG,CAAEhC,YAVZ;AAWC,MAAA,QAAQ,EAAG,KAAKI,aAXjB;AAYC,MAAA,6BAA6B,EAAG,MAAM;AACrC,aAAKK,QAAL,CAAe;AAAET,UAAAA,YAAY,EAAE;AAAhB,SAAf;AACA,OAdF;AAeC,MAAA,4BAA4B,EAAG,MAAM;AACpC,aAAKS,QAAL,CAAe;AAAET,UAAAA,YAAY,EAAE;AAAhB,SAAf;AACA;AAjBF,OADD,EAoBG8B,cAAc,IACf;AACA;AACA,kBAAC,gBAAD;AACC,MAAA,QAAQ,EAAG,CAAEF,UADd;AAEC,MAAA,OAAO,EAAG,KAAK1B,WAFhB;AAGC,MAAA,KAAK,EAAG,CAAE2B,KAAF,EAAStC,MAAM,CAAC0C,gBAAhB;AAHT,OAKC,cAAC,IAAD;AAAM,MAAA,KAAK,EAAG1C,MAAM,CAAC2C;AAArB,MALD,EAMC,cAAC,IAAD;AACC,MAAA,IAAI,EAAG1C,QADR;AAEC,MAAA,KAAK,EAAGD,MAAM,CAAC4C,QAFhB;AAGC,MAAA,IAAI,EAAG5C,MAAM,CAAC4C,QAAP,CAAgBC;AAHxB,MAND,CAvBF,CADD;AAuCA;;AA3G4B;;AA8G9B,eAAe1C,KAAf","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { Icon } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * External dependencies\n */\nimport { View, TouchableOpacity, Platform, Linking, Alert } from 'react-native';\nimport { default as VideoPlayer } from 'react-native-video';\n\n/**\n * Internal dependencies\n */\nimport styles from './styles.scss';\nimport PlayIcon from './gridicon-play';\n\n// Default Video ratio 16:9\nexport const VIDEO_ASPECT_RATIO = 16 / 9;\n\nclass Video extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.isIOS = Platform.OS === 'ios';\n\t\tthis.state = {\n\t\t\tisFullScreen: false,\n\t\t\tvideoContainerHeight: 0,\n\t\t};\n\t\tthis.onPressPlay = this.onPressPlay.bind( this );\n\t\tthis.onVideoLayout = this.onVideoLayout.bind( this );\n\t}\n\n\tonVideoLayout( event ) {\n\t\tconst { height } = event.nativeEvent.layout;\n\t\tif ( height !== this.state.videoContainerHeight ) {\n\t\t\tthis.setState( { videoContainerHeight: height } );\n\t\t}\n\t}\n\n\tonPressPlay() {\n\t\tif ( this.isIOS ) {\n\t\t\tif ( this.player ) {\n\t\t\t\tthis.player.presentFullscreenPlayer();\n\t\t\t}\n\t\t} else {\n\t\t\tconst { source } = this.props;\n\t\t\tif ( source && source.uri ) {\n\t\t\t\tthis.openURL( source.uri );\n\t\t\t}\n\t\t}\n\t}\n\n\t// Tries opening the URL outside of the app\n\topenURL( url ) {\n\t\tLinking.canOpenURL( url )\n\t\t\t.then( ( supported ) => {\n\t\t\t\tif ( ! supported ) {\n\t\t\t\t\tAlert.alert(\n\t\t\t\t\t\t__( 'Problem opening the video' ),\n\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t'No application can handle this request. Please install a Web browser.'\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t\twindow.console.warn(\n\t\t\t\t\t\t'No application found that can open the video with URL: ' +\n\t\t\t\t\t\t\turl\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\treturn Linking.openURL( url );\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.catch( ( err ) => {\n\t\t\t\tAlert.alert(\n\t\t\t\t\t__( 'Problem opening the video' ),\n\t\t\t\t\t__( 'An unknown error occurred. Please try again.' )\n\t\t\t\t);\n\t\t\t\twindow.console.error(\n\t\t\t\t\t'An error occurred while opening the video URL: ' + url,\n\t\t\t\t\terr\n\t\t\t\t);\n\t\t\t} );\n\t}\n\n\trender() {\n\t\tconst { isSelected, style } = this.props;\n\t\tconst { isFullScreen, videoContainerHeight } = this.state;\n\t\tconst showPlayButton = videoContainerHeight > 0;\n\n\t\treturn (\n\t\t\t<View style={ styles.videoContainer }>\n\t\t\t\t<VideoPlayer\n\t\t\t\t\t{ ...this.props }\n\t\t\t\t\tref={ ( ref ) => {\n\t\t\t\t\t\tthis.player = ref;\n\t\t\t\t\t} }\n\t\t\t\t\t// Using built-in player controls is messing up the layout on iOS.\n\t\t\t\t\t// So we are setting controls=false and adding a play button that\n\t\t\t\t\t// will trigger presentFullscreenPlayer()\n\t\t\t\t\tcontrols={ false }\n\t\t\t\t\tignoreSilentSwitch={ 'ignore' }\n\t\t\t\t\tpaused={ ! isFullScreen }\n\t\t\t\t\tonLayout={ this.onVideoLayout }\n\t\t\t\t\tonFullscreenPlayerWillPresent={ () => {\n\t\t\t\t\t\tthis.setState( { isFullScreen: true } );\n\t\t\t\t\t} }\n\t\t\t\t\tonFullscreenPlayerDidDismiss={ () => {\n\t\t\t\t\t\tthis.setState( { isFullScreen: false } );\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t\t{ showPlayButton && (\n\t\t\t\t\t// If we add the play icon as a subview to VideoPlayer then react-native-video decides to show control buttons\n\t\t\t\t\t// even if we set controls={ false }, so we are adding our play button as a sibling overlay view.\n\t\t\t\t\t<TouchableOpacity\n\t\t\t\t\t\tdisabled={ ! isSelected }\n\t\t\t\t\t\tonPress={ this.onPressPlay }\n\t\t\t\t\t\tstyle={ [ style, styles.overlayContainer ] }\n\t\t\t\t\t>\n\t\t\t\t\t\t<View style={ styles.blackOverlay } />\n\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\ticon={ PlayIcon }\n\t\t\t\t\t\t\tstyle={ styles.playIcon }\n\t\t\t\t\t\t\tsize={ styles.playIcon.size }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</TouchableOpacity>\n\t\t\t\t) }\n\t\t\t</View>\n\t\t);\n\t}\n}\n\nexport default Video;\n"]}