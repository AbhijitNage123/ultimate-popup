{"version":3,"sources":["@wordpress/block-editor/src/components/list-view/use-list-view-client-ids.js"],"names":["useListViewSelectedClientIds","__experimentalPersistentListViewFeatures","select","getSelectedBlockClientId","getSelectedBlockClientIds","blockEditorStore","useListViewClientIdsTree","blocks","selectedClientIds","showOnlyCurrentHierarchy","getBlockHierarchyRootClientId","__unstableGetClientIdsTree","__unstableGetClientIdWithClientIdsTree","isSingleBlockSelected","Array","isArray","rootBlock","hasHierarchy","clientId","innerBlocks","length","useListViewClientIds","clientIdsTree"],"mappings":";;;;;;;AAIA;;AAKA;;AACA;;AAVA;AACA;AACA;;AAIA;AACA;AACA;AAIA,MAAMA,4BAA4B,GACjCC,wCADoC,IAGpC,qBACGC,MAAF,IAAc;AACb,QAAM;AACLC,IAAAA,wBADK;AAELC,IAAAA;AAFK,MAGFF,MAAM,CAAEG,YAAF,CAHV;;AAKA,MAAKJ,wCAAL,EAAgD;AAC/C,WAAOG,yBAAyB,EAAhC;AACA;;AAED,SAAOD,wBAAwB,EAA/B;AACA,CAZF,EAaC,CAAEF,wCAAF,CAbD,CAHD;;AAmBA,MAAMK,wBAAwB,GAAG,CAChCC,MADgC,EAEhCC,iBAFgC,EAGhCC,wBAHgC,KAKhC,qBACGP,MAAF,IAAc;AACb,QAAM;AACLQ,IAAAA,6BADK;AAELC,IAAAA,0BAFK;AAGLC,IAAAA;AAHK,MAIFV,MAAM,CAAEG,YAAF,CAJV;;AAMA,MAAKE,MAAL,EAAc;AACb,WAAOA,MAAP;AACA;;AAED,QAAMM,qBAAqB,GAC1BL,iBAAiB,IAAI,CAAEM,KAAK,CAACC,OAAN,CAAeP,iBAAf,CADxB;;AAEA,MAAK,CAAEC,wBAAF,IAA8B,CAAEI,qBAArC,EAA6D;AAC5D,WAAOF,0BAA0B,EAAjC;AACA;;AAED,QAAMK,SAAS,GAAGJ,sCAAsC,CACvDF,6BAA6B,CAAEF,iBAAF,CAD0B,CAAxD;;AAGA,MAAK,CAAEQ,SAAP,EAAmB;AAClB,WAAOL,0BAA0B,EAAjC;AACA;;AAED,QAAMM,YAAY,GACjB,CAAE,+BAAoBD,SAAS,CAACE,QAA9B,EAAwCV,iBAAxC,CAAF,IACEQ,SAAS,CAACG,WAAV,IAAyBH,SAAS,CAACG,WAAV,CAAsBC,MAAtB,KAAiC,CAF7D;;AAGA,MAAKH,YAAL,EAAoB;AACnB,WAAO,CAAED,SAAF,CAAP;AACA;;AAED,SAAOL,0BAA0B,EAAjC;AACA,CAjCF,EAkCC,CAAEJ,MAAF,EAAUC,iBAAV,EAA6BC,wBAA7B,CAlCD,CALD;;AA0Ce,SAASY,oBAAT,CACdd,MADc,EAEdE,wBAFc,EAGdR,wCAHc,EAIb;AACD,QAAMO,iBAAiB,GAAGR,4BAA4B,CACrDC,wCADqD,CAAtD;AAGA,QAAMqB,aAAa,GAAGhB,wBAAwB,CAC7CC,MAD6C,EAE7CC,iBAF6C,EAG7CC,wBAH6C,CAA9C;AAKA,SAAO;AAAEa,IAAAA,aAAF;AAAiBd,IAAAA;AAAjB,GAAP;AACA","sourcesContent":["/**\n * WordPress dependencies\n */\n\nimport { useSelect } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport { isClientIdSelected } from './utils';\nimport { store as blockEditorStore } from '../../store';\n\nconst useListViewSelectedClientIds = (\n\t__experimentalPersistentListViewFeatures\n) =>\n\tuseSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetSelectedBlockClientId,\n\t\t\t\tgetSelectedBlockClientIds,\n\t\t\t} = select( blockEditorStore );\n\n\t\t\tif ( __experimentalPersistentListViewFeatures ) {\n\t\t\t\treturn getSelectedBlockClientIds();\n\t\t\t}\n\n\t\t\treturn getSelectedBlockClientId();\n\t\t},\n\t\t[ __experimentalPersistentListViewFeatures ]\n\t);\n\nconst useListViewClientIdsTree = (\n\tblocks,\n\tselectedClientIds,\n\tshowOnlyCurrentHierarchy\n) =>\n\tuseSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetBlockHierarchyRootClientId,\n\t\t\t\t__unstableGetClientIdsTree,\n\t\t\t\t__unstableGetClientIdWithClientIdsTree,\n\t\t\t} = select( blockEditorStore );\n\n\t\t\tif ( blocks ) {\n\t\t\t\treturn blocks;\n\t\t\t}\n\n\t\t\tconst isSingleBlockSelected =\n\t\t\t\tselectedClientIds && ! Array.isArray( selectedClientIds );\n\t\t\tif ( ! showOnlyCurrentHierarchy || ! isSingleBlockSelected ) {\n\t\t\t\treturn __unstableGetClientIdsTree();\n\t\t\t}\n\n\t\t\tconst rootBlock = __unstableGetClientIdWithClientIdsTree(\n\t\t\t\tgetBlockHierarchyRootClientId( selectedClientIds )\n\t\t\t);\n\t\t\tif ( ! rootBlock ) {\n\t\t\t\treturn __unstableGetClientIdsTree();\n\t\t\t}\n\n\t\t\tconst hasHierarchy =\n\t\t\t\t! isClientIdSelected( rootBlock.clientId, selectedClientIds ) ||\n\t\t\t\t( rootBlock.innerBlocks && rootBlock.innerBlocks.length !== 0 );\n\t\t\tif ( hasHierarchy ) {\n\t\t\t\treturn [ rootBlock ];\n\t\t\t}\n\n\t\t\treturn __unstableGetClientIdsTree();\n\t\t},\n\t\t[ blocks, selectedClientIds, showOnlyCurrentHierarchy ]\n\t);\n\nexport default function useListViewClientIds(\n\tblocks,\n\tshowOnlyCurrentHierarchy,\n\t__experimentalPersistentListViewFeatures\n) {\n\tconst selectedClientIds = useListViewSelectedClientIds(\n\t\t__experimentalPersistentListViewFeatures\n\t);\n\tconst clientIdsTree = useListViewClientIdsTree(\n\t\tblocks,\n\t\tselectedClientIds,\n\t\tshowOnlyCurrentHierarchy\n\t);\n\treturn { clientIdsTree, selectedClientIds };\n}\n"]}