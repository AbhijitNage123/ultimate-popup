{"version":3,"sources":["@wordpress/block-editor/src/components/floating-toolbar/index.native.js"],"names":["EASE_IN_DURATION","EASE_OUT_DURATION","TRANSLATION_RANGE","FloatingToolbar","selectedClientId","parentId","showFloatingToolbar","onNavigateUp","isRTL","opacity","Animated","Value","current","previousSelection","setPreviousSelection","timing","toValue","duration","easing","Easing","ease","useNativeDriver","start","clientId","translationRange","Platform","OS","translation","interpolate","inputRange","outputRange","animationStyle","transform","translateY","previousSelectedClientId","previousSelectedParentId","showPrevious","blockSelectionButtonClientId","showNavUpButton","styles","floatingToolbar","toolbar","pipe","select","getSelectedBlockClientId","getBlockHierarchyRootClientId","getBlockRootClientId","getBlockCount","getSettings","blockEditorStore","rootBlockId","dispatch","selectBlock","initialPosition"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { Animated, Easing, View, Platform } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { ToolbarButton, ToolbarGroup } from '@wordpress/components';\nimport { useEffect, useState, useRef } from '@wordpress/element';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport styles from './styles.scss';\nimport NavigateUpSVG from './nav-up-icon';\nimport BlockSelectionButton from '../block-list/block-selection-button.native';\nimport { store as blockEditorStore } from '../../store';\n\nconst EASE_IN_DURATION = 250;\nconst EASE_OUT_DURATION = 80;\nconst TRANSLATION_RANGE = 8;\n\nconst FloatingToolbar = ( {\n\tselectedClientId,\n\tparentId,\n\tshowFloatingToolbar,\n\tonNavigateUp,\n\tisRTL,\n} ) => {\n\tconst opacity = useRef( new Animated.Value( 0 ) ).current;\n\t// Sustain old selection for proper block selection button rendering when exit animation is ongoing.\n\tconst [ previousSelection, setPreviousSelection ] = useState( {} );\n\n\tuseEffect( () => {\n\t\tAnimated.timing( opacity, {\n\t\t\ttoValue: showFloatingToolbar ? 1 : 0,\n\t\t\tduration: showFloatingToolbar\n\t\t\t\t? EASE_IN_DURATION\n\t\t\t\t: EASE_OUT_DURATION,\n\t\t\teasing: Easing.ease,\n\t\t\tuseNativeDriver: true,\n\t\t} ).start();\n\t}, [ showFloatingToolbar ] );\n\n\tuseEffect( () => {\n\t\tif ( showFloatingToolbar )\n\t\t\tsetPreviousSelection( { clientId: selectedClientId, parentId } );\n\t}, [ selectedClientId ] );\n\n\tconst translationRange =\n\t\t( Platform.OS === 'android' ? -1 : 1 ) * TRANSLATION_RANGE;\n\n\tconst translation = opacity.interpolate( {\n\t\tinputRange: [ 0, 1 ],\n\t\toutputRange: [ translationRange, 0 ],\n\t} );\n\n\tconst animationStyle = {\n\t\topacity,\n\t\ttransform: [ { translateY: translation } ],\n\t};\n\n\tconst {\n\t\tclientId: previousSelectedClientId,\n\t\tparentId: previousSelectedParentId,\n\t} = previousSelection;\n\n\tconst showPrevious = previousSelectedClientId && ! showFloatingToolbar;\n\tconst blockSelectionButtonClientId = showPrevious\n\t\t? previousSelectedClientId\n\t\t: selectedClientId;\n\tconst showNavUpButton =\n\t\t!! parentId || ( showPrevious && !! previousSelectedParentId );\n\n\treturn (\n\t\t!! opacity && (\n\t\t\t<Animated.View\n\t\t\t\tstyle={ [ styles.floatingToolbar, animationStyle ] }\n\t\t\t\tpointerEvents={ showFloatingToolbar ? 'auto' : 'none' }\n\t\t\t>\n\t\t\t\t{ showNavUpButton && (\n\t\t\t\t\t<ToolbarGroup passedStyle={ styles.toolbar }>\n\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\ttitle={ __( 'Navigate Up' ) }\n\t\t\t\t\t\t\tonClick={\n\t\t\t\t\t\t\t\t! showPrevious &&\n\t\t\t\t\t\t\t\t( () => onNavigateUp( parentId ) )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ticon={ <NavigateUpSVG isRTL={ isRTL } /> }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<View style={ styles.pipe } />\n\t\t\t\t\t</ToolbarGroup>\n\t\t\t\t) }\n\t\t\t\t<BlockSelectionButton\n\t\t\t\t\tclientId={ blockSelectionButtonClientId }\n\t\t\t\t/>\n\t\t\t</Animated.View>\n\t\t)\n\t);\n};\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst {\n\t\t\tgetSelectedBlockClientId,\n\t\t\tgetBlockHierarchyRootClientId,\n\t\t\tgetBlockRootClientId,\n\t\t\tgetBlockCount,\n\t\t\tgetSettings,\n\t\t} = select( blockEditorStore );\n\n\t\tconst selectedClientId = getSelectedBlockClientId();\n\n\t\tif ( ! selectedClientId ) return;\n\n\t\tconst rootBlockId = getBlockHierarchyRootClientId( selectedClientId );\n\n\t\treturn {\n\t\t\tselectedClientId,\n\t\t\tshowFloatingToolbar: !! getBlockCount( rootBlockId ),\n\t\t\tparentId: getBlockRootClientId( selectedClientId ),\n\t\t\tisRTL: getSettings().isRTL,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { selectBlock } = dispatch( blockEditorStore );\n\n\t\treturn {\n\t\t\tonNavigateUp( clientId, initialPosition ) {\n\t\t\t\tselectBlock( clientId, initialPosition );\n\t\t\t},\n\t\t};\n\t} ),\n] )( FloatingToolbar );\n"]}