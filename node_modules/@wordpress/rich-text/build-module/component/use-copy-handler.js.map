{"version":3,"sources":["@wordpress/rich-text/src/component/use-copy-handler.js"],"names":["useRef","useRefEffect","toHTMLString","isCollapsed","slice","getTextContent","useCopyHandler","props","propsRef","current","element","onCopy","event","record","multilineTag","preserveWhiteSpace","contains","ownerDocument","activeElement","selectedRecord","plainText","html","value","clipboardData","setData","preventDefault","addEventListener","removeEventListener"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,MAAT,QAAuB,oBAAvB;AACA,SAASC,YAAT,QAA6B,oBAA7B;AAEA;AACA;AACA;;AACA,SAASC,YAAT,QAA6B,mBAA7B;AACA,SAASC,WAAT,QAA4B,iBAA5B;AACA,SAASC,KAAT,QAAsB,UAAtB;AACA,SAASC,cAAT,QAA+B,qBAA/B;AAEA,OAAO,SAASC,cAAT,CAAyBC,KAAzB,EAAiC;AACvC,QAAMC,QAAQ,GAAGR,MAAM,CAAEO,KAAF,CAAvB;AACAC,EAAAA,QAAQ,CAACC,OAAT,GAAmBF,KAAnB;AACA,SAAON,YAAY,CAAIS,OAAF,IAAe;AACnC,aAASC,MAAT,CAAiBC,KAAjB,EAAyB;AACxB,YAAM;AACLC,QAAAA,MADK;AAELC,QAAAA,YAFK;AAGLC,QAAAA;AAHK,UAIFP,QAAQ,CAACC,OAJb;;AAKA,UACCN,WAAW,CAAEU,MAAM,CAACJ,OAAT,CAAX,IACA,CAAEC,OAAO,CAACM,QAAR,CAAkBN,OAAO,CAACO,aAAR,CAAsBC,aAAxC,CAFH,EAGE;AACD;AACA;;AAED,YAAMC,cAAc,GAAGf,KAAK,CAAES,MAAM,CAACJ,OAAT,CAA5B;AACA,YAAMW,SAAS,GAAGf,cAAc,CAAEc,cAAF,CAAhC;AACA,YAAME,IAAI,GAAGnB,YAAY,CAAE;AAC1BoB,QAAAA,KAAK,EAAEH,cADmB;AAE1BL,QAAAA,YAF0B;AAG1BC,QAAAA;AAH0B,OAAF,CAAzB;AAKAH,MAAAA,KAAK,CAACW,aAAN,CAAoBC,OAApB,CAA6B,YAA7B,EAA2CJ,SAA3C;AACAR,MAAAA,KAAK,CAACW,aAAN,CAAoBC,OAApB,CAA6B,WAA7B,EAA0CH,IAA1C;AACAT,MAAAA,KAAK,CAACW,aAAN,CAAoBC,OAApB,CAA6B,WAA7B,EAA0C,MAA1C;AACAZ,MAAAA,KAAK,CAACa,cAAN;AACA;;AAEDf,IAAAA,OAAO,CAACgB,gBAAR,CAA0B,MAA1B,EAAkCf,MAAlC;AACA,WAAO,MAAM;AACZD,MAAAA,OAAO,CAACiB,mBAAR,CAA6B,MAA7B,EAAqChB,MAArC;AACA,KAFD;AAGA,GA/BkB,EA+BhB,EA/BgB,CAAnB;AAgCA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useRef } from '@wordpress/element';\nimport { useRefEffect } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { toHTMLString } from '../to-html-string';\nimport { isCollapsed } from '../is-collapsed';\nimport { slice } from '../slice';\nimport { getTextContent } from '../get-text-content';\n\nexport function useCopyHandler( props ) {\n\tconst propsRef = useRef( props );\n\tpropsRef.current = props;\n\treturn useRefEffect( ( element ) => {\n\t\tfunction onCopy( event ) {\n\t\t\tconst {\n\t\t\t\trecord,\n\t\t\t\tmultilineTag,\n\t\t\t\tpreserveWhiteSpace,\n\t\t\t} = propsRef.current;\n\t\t\tif (\n\t\t\t\tisCollapsed( record.current ) ||\n\t\t\t\t! element.contains( element.ownerDocument.activeElement )\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst selectedRecord = slice( record.current );\n\t\t\tconst plainText = getTextContent( selectedRecord );\n\t\t\tconst html = toHTMLString( {\n\t\t\t\tvalue: selectedRecord,\n\t\t\t\tmultilineTag,\n\t\t\t\tpreserveWhiteSpace,\n\t\t\t} );\n\t\t\tevent.clipboardData.setData( 'text/plain', plainText );\n\t\t\tevent.clipboardData.setData( 'text/html', html );\n\t\t\tevent.clipboardData.setData( 'rich-text', 'true' );\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\telement.addEventListener( 'copy', onCopy );\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'copy', onCopy );\n\t\t};\n\t}, [] );\n}\n"]}