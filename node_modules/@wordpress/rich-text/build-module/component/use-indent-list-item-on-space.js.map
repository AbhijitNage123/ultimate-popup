{"version":3,"sources":["@wordpress/rich-text/src/component/use-indent-list-item-on-space.js"],"names":["useRef","useRefEffect","SPACE","isCollapsed","LINE_SEPARATOR","indentListItems","useIndentListItemOnSpace","props","propsRef","current","element","onKeyDown","event","keyCode","shiftKey","altKey","metaKey","ctrlKey","multilineTag","createRecord","handleChange","currentValue","text","start","characterBefore","type","tagName","toLowerCase","preventDefault","addEventListener","removeEventListener"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,MAAT,QAAuB,oBAAvB;AACA,SAASC,YAAT,QAA6B,oBAA7B;AACA,SAASC,KAAT,QAAsB,qBAAtB;AAEA;AACA;AACA;;AACA,SAASC,WAAT,QAA4B,iBAA5B;AACA,SAASC,cAAT,QAA+B,uBAA/B;AACA,SAASC,eAAT,QAAgC,sBAAhC;AAEA,OAAO,SAASC,wBAAT,CAAmCC,KAAnC,EAA2C;AACjD,QAAMC,QAAQ,GAAGR,MAAM,CAAEO,KAAF,CAAvB;AACAC,EAAAA,QAAQ,CAACC,OAAT,GAAmBF,KAAnB;AACA,SAAON,YAAY,CAAIS,OAAF,IAAe;AACnC,aAASC,SAAT,CAAoBC,KAApB,EAA4B;AAC3B,YAAM;AAAEC,QAAAA,OAAF;AAAWC,QAAAA,QAAX;AAAqBC,QAAAA,MAArB;AAA6BC,QAAAA,OAA7B;AAAsCC,QAAAA;AAAtC,UAAkDL,KAAxD;AACA,YAAM;AACLM,QAAAA,YADK;AAELC,QAAAA,YAFK;AAGLC,QAAAA;AAHK,UAIFZ,QAAQ,CAACC,OAJb;;AAMA,WACC;AACAK,MAAAA,QAAQ,IACRC,MADA,IAEAC,OAFA,IAGAC,OAHA,IAIAJ,OAAO,KAAKX,KAJZ,IAKAgB,YAAY,KAAK,IAPlB,EAQE;AACD;AACA;;AAED,YAAMG,YAAY,GAAGF,YAAY,EAAjC;;AAEA,UAAK,CAAEhB,WAAW,CAAEkB,YAAF,CAAlB,EAAqC;AACpC;AACA;;AAED,YAAM;AAAEC,QAAAA,IAAF;AAAQC,QAAAA;AAAR,UAAkBF,YAAxB;AACA,YAAMG,eAAe,GAAGF,IAAI,CAAEC,KAAK,GAAG,CAAV,CAA5B,CA3B2B,CA6B3B;;AACA,UAAKC,eAAe,IAAIA,eAAe,KAAKpB,cAA5C,EAA6D;AAC5D;AACA;;AAEDgB,MAAAA,YAAY,CACXf,eAAe,CAAEgB,YAAF,EAAgB;AAC9BI,QAAAA,IAAI,EAAEf,OAAO,CAACgB,OAAR,CAAgBC,WAAhB;AADwB,OAAhB,CADJ,CAAZ;AAKAf,MAAAA,KAAK,CAACgB,cAAN;AACA;;AAEDlB,IAAAA,OAAO,CAACmB,gBAAR,CAA0B,SAA1B,EAAqClB,SAArC;AACA,WAAO,MAAM;AACZD,MAAAA,OAAO,CAACoB,mBAAR,CAA6B,SAA7B,EAAwCnB,SAAxC;AACA,KAFD;AAGA,GA/CkB,EA+ChB,EA/CgB,CAAnB;AAgDA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useRef } from '@wordpress/element';\nimport { useRefEffect } from '@wordpress/compose';\nimport { SPACE } from '@wordpress/keycodes';\n\n/**\n * Internal dependencies\n */\nimport { isCollapsed } from '../is-collapsed';\nimport { LINE_SEPARATOR } from '../special-characters';\nimport { indentListItems } from '../indent-list-items';\n\nexport function useIndentListItemOnSpace( props ) {\n\tconst propsRef = useRef( props );\n\tpropsRef.current = props;\n\treturn useRefEffect( ( element ) => {\n\t\tfunction onKeyDown( event ) {\n\t\t\tconst { keyCode, shiftKey, altKey, metaKey, ctrlKey } = event;\n\t\t\tconst {\n\t\t\t\tmultilineTag,\n\t\t\t\tcreateRecord,\n\t\t\t\thandleChange,\n\t\t\t} = propsRef.current;\n\n\t\t\tif (\n\t\t\t\t// Only override when no modifiers are pressed.\n\t\t\t\tshiftKey ||\n\t\t\t\taltKey ||\n\t\t\t\tmetaKey ||\n\t\t\t\tctrlKey ||\n\t\t\t\tkeyCode !== SPACE ||\n\t\t\t\tmultilineTag !== 'li'\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst currentValue = createRecord();\n\n\t\t\tif ( ! isCollapsed( currentValue ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { text, start } = currentValue;\n\t\t\tconst characterBefore = text[ start - 1 ];\n\n\t\t\t// The caret must be at the start of a line.\n\t\t\tif ( characterBefore && characterBefore !== LINE_SEPARATOR ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\thandleChange(\n\t\t\t\tindentListItems( currentValue, {\n\t\t\t\t\ttype: element.tagName.toLowerCase(),\n\t\t\t\t} )\n\t\t\t);\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\telement.addEventListener( 'keydown', onKeyDown );\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'keydown', onKeyDown );\n\t\t};\n\t}, [] );\n}\n"]}