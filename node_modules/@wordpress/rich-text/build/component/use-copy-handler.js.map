{"version":3,"sources":["@wordpress/rich-text/src/component/use-copy-handler.js"],"names":["useCopyHandler","props","propsRef","current","element","onCopy","event","record","multilineTag","preserveWhiteSpace","contains","ownerDocument","activeElement","selectedRecord","plainText","html","value","clipboardData","setData","preventDefault","addEventListener","removeEventListener"],"mappings":";;;;;;;AAGA;;AACA;;AAKA;;AACA;;AACA;;AACA;;AAZA;AACA;AACA;;AAIA;AACA;AACA;AAMO,SAASA,cAAT,CAAyBC,KAAzB,EAAiC;AACvC,QAAMC,QAAQ,GAAG,qBAAQD,KAAR,CAAjB;AACAC,EAAAA,QAAQ,CAACC,OAAT,GAAmBF,KAAnB;AACA,SAAO,2BAAgBG,OAAF,IAAe;AACnC,aAASC,MAAT,CAAiBC,KAAjB,EAAyB;AACxB,YAAM;AACLC,QAAAA,MADK;AAELC,QAAAA,YAFK;AAGLC,QAAAA;AAHK,UAIFP,QAAQ,CAACC,OAJb;;AAKA,UACC,8BAAaI,MAAM,CAACJ,OAApB,KACA,CAAEC,OAAO,CAACM,QAAR,CAAkBN,OAAO,CAACO,aAAR,CAAsBC,aAAxC,CAFH,EAGE;AACD;AACA;;AAED,YAAMC,cAAc,GAAG,kBAAON,MAAM,CAACJ,OAAd,CAAvB;AACA,YAAMW,SAAS,GAAG,oCAAgBD,cAAhB,CAAlB;AACA,YAAME,IAAI,GAAG,gCAAc;AAC1BC,QAAAA,KAAK,EAAEH,cADmB;AAE1BL,QAAAA,YAF0B;AAG1BC,QAAAA;AAH0B,OAAd,CAAb;AAKAH,MAAAA,KAAK,CAACW,aAAN,CAAoBC,OAApB,CAA6B,YAA7B,EAA2CJ,SAA3C;AACAR,MAAAA,KAAK,CAACW,aAAN,CAAoBC,OAApB,CAA6B,WAA7B,EAA0CH,IAA1C;AACAT,MAAAA,KAAK,CAACW,aAAN,CAAoBC,OAApB,CAA6B,WAA7B,EAA0C,MAA1C;AACAZ,MAAAA,KAAK,CAACa,cAAN;AACA;;AAEDf,IAAAA,OAAO,CAACgB,gBAAR,CAA0B,MAA1B,EAAkCf,MAAlC;AACA,WAAO,MAAM;AACZD,MAAAA,OAAO,CAACiB,mBAAR,CAA6B,MAA7B,EAAqChB,MAArC;AACA,KAFD;AAGA,GA/BM,EA+BJ,EA/BI,CAAP;AAgCA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useRef } from '@wordpress/element';\nimport { useRefEffect } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { toHTMLString } from '../to-html-string';\nimport { isCollapsed } from '../is-collapsed';\nimport { slice } from '../slice';\nimport { getTextContent } from '../get-text-content';\n\nexport function useCopyHandler( props ) {\n\tconst propsRef = useRef( props );\n\tpropsRef.current = props;\n\treturn useRefEffect( ( element ) => {\n\t\tfunction onCopy( event ) {\n\t\t\tconst {\n\t\t\t\trecord,\n\t\t\t\tmultilineTag,\n\t\t\t\tpreserveWhiteSpace,\n\t\t\t} = propsRef.current;\n\t\t\tif (\n\t\t\t\tisCollapsed( record.current ) ||\n\t\t\t\t! element.contains( element.ownerDocument.activeElement )\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst selectedRecord = slice( record.current );\n\t\t\tconst plainText = getTextContent( selectedRecord );\n\t\t\tconst html = toHTMLString( {\n\t\t\t\tvalue: selectedRecord,\n\t\t\t\tmultilineTag,\n\t\t\t\tpreserveWhiteSpace,\n\t\t\t} );\n\t\t\tevent.clipboardData.setData( 'text/plain', plainText );\n\t\t\tevent.clipboardData.setData( 'text/html', html );\n\t\t\tevent.clipboardData.setData( 'rich-text', 'true' );\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\telement.addEventListener( 'copy', onCopy );\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'copy', onCopy );\n\t\t};\n\t}, [] );\n}\n"]}