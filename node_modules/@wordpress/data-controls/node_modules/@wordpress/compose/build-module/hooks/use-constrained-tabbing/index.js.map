{"version":3,"sources":["@wordpress/compose/src/hooks/use-constrained-tabbing/index.js"],"names":["TAB","focus","useCallback","useConstrainedTabbing","ref","node","addEventListener","event","window","KeyboardEvent","keyCode","tabbables","tabbable","find","length","firstTabbable","lastTabbable","shiftKey","target","preventDefault","includes"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,GAAT,QAAoB,qBAApB;AACA,SAASC,KAAT,QAAsB,gBAAtB;AACA,SAASC,WAAT,QAA4B,oBAA5B;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASC,qBAAT,GAAiC;AAChC,QAAMC,GAAG,GAAGF,WAAW;AAAI;AAAuBG,EAAAA,IAAzB,IAAmC;AAC3D,QAAK,CAAEA,IAAP,EAAc;AACb;AACA;;AACDA,IAAAA,IAAI,CAACC,gBAAL,CAAuB,SAAvB;AAAoC;AAAqBC,IAAAA,KAAvB,IAAkC;AACnE,UAAK,EAAIA,KAAK,YAAYC,MAAM,CAACC,aAA5B,CAAL,EAAmD;AAClD;AACA;;AAED,UAAKF,KAAK,CAACG,OAAN,KAAkBV,GAAvB,EAA6B;AAC5B;AACA;;AAED,YAAMW,SAAS,GAAGV,KAAK,CAACW,QAAN,CAAeC,IAAf,CAAqBR,IAArB,CAAlB;;AACA,UAAK,CAAEM,SAAS,CAACG,MAAjB,EAA0B;AACzB;AACA;;AACD,YAAMC,aAAa,GAAGJ,SAAS,CAAE,CAAF,CAA/B;AACA,YAAMK,YAAY,GAAGL,SAAS,CAAEA,SAAS,CAACG,MAAV,GAAmB,CAArB,CAA9B;;AAEA,UAAKP,KAAK,CAACU,QAAN,IAAkBV,KAAK,CAACW,MAAN,KAAiBH,aAAxC,EAAwD;AACvDR,QAAAA,KAAK,CAACY,cAAN;AACA;;AAA6BH,QAAAA,YAAF,CAAiBf,KAAjB;AAC3B,OAHD,MAGO,IAAK,CAAEM,KAAK,CAACU,QAAR,IAAoBV,KAAK,CAACW,MAAN,KAAiBF,YAA1C,EAAyD;AAC/DT,QAAAA,KAAK,CAACY,cAAN;AACA;;AAA6BJ,QAAAA,aAAF,CAAkBd,KAAlB;AAC3B;AACJ;AACA;AACA;AACI,OAPM,MAOA,IACN,CAAEU,SAAS,CAACS,QAAV;AAAoB;AAAyBb,MAAAA,KAAK,CAACW,MAAnD,CADI,EAEL;AACDX,QAAAA,KAAK,CAACY,cAAN;AACA;;AAA6BJ,QAAAA,aAAF,CAAkBd,KAAlB;AAC3B;AACD,KAhCD;AAiCA,GArCsB,EAqCpB,EArCoB,CAAvB;AAuCA,SAAOG,GAAP;AACA;;AAED,eAAeD,qBAAf","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { TAB } from '@wordpress/keycodes';\nimport { focus } from '@wordpress/dom';\nimport { useCallback } from '@wordpress/element';\n\n/**\n * In Dialogs/modals, the tabbing must be constrained to the content of\n * the wrapper element. This hook adds the behavior to the returned ref.\n *\n * @return {import('react').RefCallback<Element>} Element Ref.\n *\n * @example\n * ```js\n * import { useConstrainedTabbing } from '@wordpress/compose';\n *\n * const ConstrainedTabbingExample = () => {\n *     const constrainedTabbingRef = useConstrainedTabbing()\n *     return (\n *         <div ref={ constrainedTabbingRef }>\n *             <Button />\n *             <Button />\n *         </div>\n *     );\n * }\n * ```\n */\nfunction useConstrainedTabbing() {\n\tconst ref = useCallback( ( /** @type {Element} */ node ) => {\n\t\tif ( ! node ) {\n\t\t\treturn;\n\t\t}\n\t\tnode.addEventListener( 'keydown', ( /** @type {Event} */ event ) => {\n\t\t\tif ( ! ( event instanceof window.KeyboardEvent ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( event.keyCode !== TAB ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst tabbables = focus.tabbable.find( node );\n\t\t\tif ( ! tabbables.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst firstTabbable = tabbables[ 0 ];\n\t\t\tconst lastTabbable = tabbables[ tabbables.length - 1 ];\n\n\t\t\tif ( event.shiftKey && event.target === firstTabbable ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\t/** @type {HTMLElement} */ ( lastTabbable ).focus();\n\t\t\t} else if ( ! event.shiftKey && event.target === lastTabbable ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\t/** @type {HTMLElement} */ ( firstTabbable ).focus();\n\t\t\t\t/*\n\t\t\t\t * When pressing Tab and none of the tabbables has focus, the keydown\n\t\t\t\t * event happens on the wrapper div: move focus on the first tabbable.\n\t\t\t\t */\n\t\t\t} else if (\n\t\t\t\t! tabbables.includes( /** @type {Element} */ ( event.target ) )\n\t\t\t) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\t/** @type {HTMLElement} */ ( firstTabbable ).focus();\n\t\t\t}\n\t\t} );\n\t}, [] );\n\n\treturn ref;\n}\n\nexport default useConstrainedTabbing;\n"]}